@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Procurement (RECOMMENDATION (MEDICINE))";
}

<br />
<div class="card border-primary text-left" style="width: 65%;">
    <div class="card-header">
        <ul class="nav nav-tabs card-header-tabs">
            <li class="nav-item">
                <a class="nav-link" asp-controller="Procurement" asp-action="Print">SUPPLIER</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" asp-controller="Procurement" asp-action="Gas">RECOMMENDATION (GOODS AND SERVICES)</a>
            </li>
            <li class="nav-item active">
                <a class="nav-link" asp-controller="Procurement" asp-action="Medicine">RECOMMENDATION (MEDICINE)</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" asp-controller="Procurement" asp-action="TwgGoods">TWG (GOODS)</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" asp-controller="Procurement" asp-action="TwgMedicine">TWG (MEDICINE)</a>
            </li>
        </ul>
    </div>
    <div class="card-body tab-content">
        <div role="tabpanel" class="tab-pane active" id="tab1">
            <div class="row">
                <div class="col-md-2">
                    <h5 class="card-title">Pr No.</h5>
                    <select type="text" id="gas" asp-items="@ViewBag.PrId" style="width: 150px;">
                        <option value="">Select Pr</option>
                    </select>
                </div>
                <div class="col-md-2">
                    <h5 class="card-title">Date</h5>
                    <input type="date" id="date">
                </div>
            </div>
        </div>
        <br />
        <a id="printButton" class="btn btn-xs btn-primary btn-edit" target="_blank">
            <i class="ace-icon fa fa-print"></i> Print
        </a>
    </div>
</div>

<script>
    $(document).ready(function () {
        $("#printButton").click(function () {
            var gasValue = $("#gas").val();
            var dateValue = $("#date").val();

            $.ajax({
                type: "POST",
                url: "@Url.Action("PrintRecommendationMeds","Procurement")",
                data: {
                    gasValue: gasValue,
                    dateValue: dateValue
                },
                success: function (data) {
                    var newTab = window.open();
                    if (newTab !== null) {
                        newTab.document.write('<embed width="100%" height="100%" type="application/pdf" src="data:application/pdf;base64,' + data.pdf + '" />');
                    } else {
                        console.error("Failed to open a new window.");
                    }
                },
                error: function (error) {
                    console.error("Error generating PDF: ", error);
                }
            });
        });
    });
</script>